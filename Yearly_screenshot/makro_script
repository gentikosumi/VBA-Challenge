Sub Multipe_year_stock_dta()Dim LastRow As LongDim percentChange As SingleDim ws As WorksheetFor Each ws In Worksheets'set title Column    ws.Range("I1").Value = "Ticker"    ws.Range("J1").Value = "Yearly Change"    ws.Range("K1").Value = "Percent Change"    ws.Range("L1").Value = "Total Stock Volume"    'set initial values    y = 0    Total = o    Change = 0    Start = 2    'find the lastrow with data    LastRow = ws.Cells(Rows.Count, "A").End(xlUp).Row        For x = 2 To LastRow        If ws.Cells(x + 1, 1).Value <> ws.Cells(x, 1).Value Then            Total = Total + ws.Cells(x, 7).Value                            If Total = 0 Then                                    ws.Range("I" & y + 2).Value = Cells(x, 1).Value                    ws.Range("J" & y + 2).Value = 0                    ws.Range("K" & y + 2).Value = "%" & 0                    ws.Range("L" & y + 2).Value = 0                                    Else                    If ws.Cells(Start, 3).Value = 0 Then                        For findVal = Start To x                            If ws.Cells(findVal, 3).Value <> 0 Then                                Start = findVal                                Exit For                            End If                        Next findVal                    End If                        'calculation    Change = (ws.Cells(x, 6) - ws.Cells(Start, 3))    percentChange = Round((Change / ws.Cells(Start, 3) * 100), 2)        'starting the next stock ticker    Start = x + 1        'print the results                        ws.Range("I" & y + 2).Value = Cells(x, 1).Value                    ws.Range("J" & y + 2).Value = Round(Change, 2)                    ws.Range("K" & y + 2).Value = "%" & percentChange                    ws.Range("L" & y + 2).Value = Total            End If                'reset variables for next stock ticker            Total = 0        Change = 0        y = y + 1                Else            Total = Total + ws.Cells(x, 7).Value        End If            Next x        'coloring the Yearly Change data            For x = 2 To LastRow            If ws.Cells(x, 10).Value >= 0 Then            ws.Cells(x, 10).Interior.ColorIndex = 4                        Else                ws.Cells(x, 10).Interior.ColorIndex = 3                End If                Next x        'set the Greater % Increase, Greater % Decrease and Great Total Stock Volume    ws.Range("O3").Value = "Greatest % Increase"    ws.Range("O4").Value = "Greatest % Decrease"    ws.Range("O5").Value = "Greatest Total Stock Volume"            Dim Increase As Double    Dim Decrease As Double        Increase = ws.Cells(2, 11).Value               For x = 2 To LastRow                    If ws.Cells(x, 11).Value > Increase Then                Increase = ws.Cells(x, 11).Value                currentTicker = ws.Cells(x, 9).Value            End If                                        ws.Range("P3").Value = "%" & Increase * 100            ws.Range("Q3").Value = currentTicker                   Next x        Decrease = ws.Cells(2, 11).Value            For x = 2 To LastRow                    If ws.Cells(x, 11).Value < Decrease Then                Decrease = ws.Cells(x, 11).Value                currentTicker = ws.Cells(x, 9).Value            End If                                        ws.Range("P4").Value = "%" & Decrease * 100            ws.Range("Q4").Value = currentTicker                Next x        greatestotal = ws.Cells(2, 12).Value            For x = 2 To LastRow                    If ws.Cells(x, 12).Value > greatestotal Then                greatestotal = ws.Cells(x, 12).Value                currentTicker = ws.Cells(x, 9).Value            End If                        ws.Range("P5").Value = greatestotal            ws.Range("Q5").Value = currentTicker                    Next x                Next ws            End SubEnd Sub